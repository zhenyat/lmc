<h1>Матрица компетенций </h1>
<table class="ztTable">
  <thead>
    <th>Кластер компетенций</th>
    <th><%= @positions[0] %></th>
    <th><%= @positions[1] %></th>
    <th><%= @positions[2] %></th>
    <th><%= @positions[3] %></th>
  </thead>
  <tbody>
    <% @clusters.each do |cluster| %>
      <% rows = @matrix[cluster.name].count %>
      <tr>
        <td rowspan='<%= rows %>'><%= cluster.title %></td>
          <% @matrix[cluster.name].each do |row| %>
            <% title =  Competency.find_by_name(row.first).title%>
            <td><%= link_to(title, '/pages/demo', class: "popup", name_co: row.first, name_po: 'seller') %></td>
            <td><%= row.last.include?('dept_manager')   ? title : '' %></td>
            <td><%= row.last.include?('sector_head')    ? title : '' %></td>
            <td><%= row.last.include?('store_director') ? title : '' %></td>
          </tr>
      <% end %>   <%# Competency Loop%>
    <% end %>     <%# Cluster Loop%>
  </tbody>
</table>
<script>
  $('.popup').click(function(event) {
      event.preventDefault();
      window.open($(this).attr("href"), "popupWindow", "width=1000, height=800, scrollars=yes");
  });
</script>
